{% extends 'base_content.html' %}

{% block content %}
<div class="container mt-5">
    <h1>Welcome to Your Dashboard, {{ tutor_name }}!</h1>

    <!-- Allocated Lessons Section -->
    <h2>Allocated Lessons</h2>
    <table class="table table-bordered">
        <thead>
            <tr>
                <th>Student Name</th>
                <th>Subject</th>
                <th>Start Time</th>
                <th>End Time</th>
                <th>Status</th>
            </tr>
        </thead>
        <tbody>
            {% for lesson in lessons %}
            <tr>
                <td>{{ lesson.student.first_name }} {{ lesson.student.last_name }}</td>
                <td>{{ lesson.subject }}</td>
                <td>{{ lesson.start_time }}</td>
                <td>{{ lesson.end_time }}</td>
                <td>{{ lesson.status }}</td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="5" class="text-center">No lessons allocated.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <!-- Tutor Requests Section -->
    <h2>Your Requests</h2>
    <a href="{% url 'submit_tutor_request' %}" class="btn btn-primary mb-3">Submit Availability</a>
    <table class="table table-bordered">
        <thead>
            <tr>
                <th>Languages</th>
                <th>Available Time</th>
                <th>Additional Details</th>
                <th>Status</th>
            </tr>
        </thead>
        <tbody>
            {% for request in tutor_requests %}
            <tr>
                <td>{{ request.languages }}</td>
                <td>{{ request.available_time }}</td>
                <td>{{ request.additional_details }}</td>
                <td>
                    <span class="badge {% if request.status == 'available' %}bg-success{% else %}bg-danger{% endif %}">
                        {{ request.status }}
                    </span>
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="4" class="text-center">No tutor requests available.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <!-- Feedback Section -->
    <h2>Feedback from Students</h2>
    <table class="table table-bordered">
        <thead>
            <tr>
                <th>Student Name</th>
                <th>Email</th>
                <th>Message</th>
                <th>Lesson Subject</th>
                <th>Submitted At</th>
            </tr>
        </thead>
        <tbody>
            {% for feedback in feedbacks %}
            <tr>
                <td>{{ feedback.lesson.student.get_full_name }}</td>
                <td>{{ feedback.email }}</td>
                <td>{{ feedback.message }}</td>
                <td>{{ feedback.lesson.subject }}</td>
                <td>{{ feedback.posted }}</td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="5" class="text-center">No feedback available.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}

